{% extends "layout.html" %}

{% block title %}Setup Wizard Â· Financial Command Center AI{% endblock %}

{% block content %}
<div class="space-y-10">
    <!-- Header Section -->
    <div class="card border border-border/70 p-7 shadow-card">
        <div class="space-y-6">
            <div class="space-y-3">
                <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-muted-foreground">
                    <i data-lucide="sparkles" class="h-3.5 w-3.5"></i>
                    Setup Wizard
                </span>
                <h1 class="text-3xl font-semibold tracking-tight sm:text-4xl">Secure integration wizard</h1>
                <p class="text-base text-muted-foreground sm:text-lg">Connect Stripe, Plaid, and Xero credentials with guided validation. Secrets stay encrypted on this device.</p>
            </div>

            <!-- Progress Bar -->
            <div class="space-y-3">
                <div class="relative h-2 w-full rounded-full bg-muted/60">
                    <div class="absolute inset-y-0 left-0 h-full rounded-full bg-primary transition-all duration-300" id="progressFill" style="width: 0%;"></div>
                </div>
                <div class="text-xs font-medium uppercase tracking-[0.32em] text-muted-foreground">
                    Step <span id="currentStepLabel">0</span> of 4
                </div>
            </div>
        </div>
    </div>

    <!-- Welcome Section -->
    <div class="card border border-border/70 p-6 space-y-6">
        <div class="space-y-3">
            <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-muted-foreground">
                <i data-lucide="sparkles" class="h-3.5 w-3.5"></i>
                Welcome
            </span>
            <h2 class="text-2xl font-semibold text-foreground">Welcome to Financial Command Center</h2>
            <p class="text-sm leading-relaxed text-muted-foreground">We'll guide you through connecting each integration, testing the credentials, and storing everything using the encrypted configuration manager.</p>
        </div>

        <div class="grid gap-4 md:grid-cols-3">
            <div class="card border border-border/70 p-6">
                <div class="flex items-start gap-3">
                    <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                        <i data-lucide="credit-card" class="h-5 w-5"></i>
                    </span>
                    <div>
                        <h3 class="text-base font-semibold text-foreground">Stripe payments</h3>
                        <p class="mt-1 text-sm text-muted-foreground">Capture charges, manage customers, and monitor payouts directly from the Command Center.</p>
                    </div>
                </div>
            </div>
            <div class="card border border-border/70 p-6">
                <div class="flex items-start gap-3">
                    <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                        <i data-lucide="banknote" class="h-5 w-5"></i>
                    </span>
                    <div>
                        <h3 class="text-base font-semibold text-foreground">Plaid banking</h3>
                        <p class="mt-1 text-sm text-muted-foreground">Stream sandbox or live banking data to demo real balance insights and transactions.</p>
                    </div>
                </div>
            </div>
            <div class="card border border-border/70 p-6">
                <div class="flex items-start gap-3">
                    <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                        <i data-lucide="file-text" class="h-5 w-5"></i>
                    </span>
                    <div>
                        <h3 class="text-base font-semibold text-foreground">Xero accounting</h3>
                        <p class="mt-1 text-sm text-muted-foreground">Sync invoices, contacts, and organisation metadata for unified financial reporting.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex items-center justify-between gap-3 border-t border-border/60 pt-6">
            <p class="text-sm text-muted-foreground">You can skip any integration and return later from the admin dashboard.</p>
            <button type="button" class="inline-flex items-center gap-2 rounded-lg bg-primary px-5 py-2.5 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90" onclick="beginSetup()">
                Begin setup
                <i data-lucide="arrow-right" class="h-4 w-4"></i>
            </button>
        </div>
    </div>

    <!-- Setup Steps -->
    <div class="space-y-8" id="setupSteps" style="display: none;">
        <!-- Step 1: Stripe -->
        <section class="step active" id="step1">
            <div class="card border border-border/70 p-6 space-y-6">
                <div class="space-y-3">
                    <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-muted-foreground">
                        Step 1 of 4
                    </span>
                    <h2 class="text-2xl font-semibold text-foreground">Connect Stripe</h2>
                    <p class="text-sm leading-relaxed text-muted-foreground">Use a restricted key wherever possible. The wizard encrypts values at rest and never transmits them externally.</p>
                </div>

                <div id="stripe-messages" class="space-y-3"></div>

                <div class="card border border-border/70 p-6" id="stripeCard">
                    <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
                        <div class="flex items-center gap-3">
                            <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                                <i data-lucide="credit-card" class="h-5 w-5"></i>
                            </span>
                            <div>
                                <h3 class="text-base font-semibold text-foreground">Stripe API configuration</h3>
                                <p class="mt-1 text-sm text-muted-foreground">Validate connectivity before saving credentials.</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground" id="stripeStatus">Pending</span>
                    </div>

                    <form id="stripeForm" onsubmit="event.preventDefault();" class="space-y-4">
                        <div class="space-y-2">
                            <label class="text-sm font-medium text-foreground" for="stripeApiKey">Stripe secret key</label>
                            <input type="password" id="stripeApiKey" name="stripe_api_key" placeholder="sk_live_... or sk_test_..." autocomplete="off" class="w-full rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20" />
                            <p class="text-xs text-muted-foreground">Starts with sk_test_ for sandbox or sk_live_ for production.</p>
                        </div>
                        <div class="space-y-2">
                            <label class="text-sm font-medium text-foreground" for="stripePublishableKey">Publishable key (optional)</label>
                            <input type="text" id="stripePublishableKey" name="stripe_publishable_key" placeholder="pk_live_... or pk_test_..." autocomplete="off" class="w-full rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20" />
                            <p class="text-xs text-muted-foreground">Required if you plan to demonstrate client-side payment flows.</p>
                        </div>
                        <div class="mt-6 flex flex-wrap items-center gap-3">
                            <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-border/70 bg-muted/60 px-4 py-2 text-sm font-medium text-foreground transition hover:border-primary/40 hover:text-primary" onclick="testStripeConnection()">
                                <span id="stripeTestSpinner" class="inline-flex items-center gap-2 text-sm font-medium text-muted-foreground" style="display: none;">
                                    <div class="h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground/40 border-t-primary"></div>
                                    Testing
                                </span>
                                <span id="stripeTestText">Test connection</span>
                            </button>
                        </div>
                    </form>
                </div>

                <div class="flex flex-wrap items-center justify-between gap-3 border-t border-border/60 pt-6">
                    <div></div>
                    <div class="flex flex-wrap items-center gap-3">
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-transparent px-4 py-2 text-sm font-medium text-muted-foreground transition hover:text-foreground" onclick="skipStripe()">Skip for now</button>
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg bg-primary px-5 py-2.5 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90" onclick="nextStep()" id="stripeNext" disabled>
                            Continue to Plaid
                            <i data-lucide="arrow-right" class="h-4 w-4"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 2: Plaid -->
        <section class="step" id="step2" style="display: none;">
            <div class="card border border-border/70 p-6 space-y-6">
                <div class="space-y-3">
                    <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-muted-foreground">
                        Step 2 of 4
                    </span>
                    <h2 class="text-2xl font-semibold text-foreground">Configure Plaid banking</h2>
                    <p class="text-sm leading-relaxed text-muted-foreground">Supply sandbox credentials to demonstrate flows instantly, or connect production once you're ready.</p>
                </div>

                <div id="plaid-messages" class="space-y-3"></div>

                <div class="card border border-border/70 p-6" id="plaidCard">
                    <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
                        <div class="flex items-center gap-3">
                            <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                                <i data-lucide="banknote" class="h-5 w-5"></i>
                            </span>
                            <div>
                                <h3 class="text-base font-semibold text-foreground">Plaid API credentials</h3>
                                <p class="mt-1 text-sm text-muted-foreground">Supports sandbox, development, and production environments.</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground" id="plaidStatus">Pending</span>
                    </div>

                    <form id="plaidForm" onsubmit="event.preventDefault();" class="space-y-4">
                        <div class="grid gap-4 md:grid-cols-2">
                            <div class="space-y-2">
                                <label class="text-sm font-medium text-foreground" for="plaidClientId">Plaid client ID</label>
                                <input type="text" id="plaidClientId" name="plaid_client_id" placeholder="client id" autocomplete="off" class="w-full rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20" />
                                <p class="text-xs text-muted-foreground">Available in the Plaid dashboard.</p>
                            </div>
                            <div class="space-y-2">
                                <label class="text-sm font-medium text-foreground" for="plaidSecret">Plaid secret</label>
                                <input type="password" id="plaidSecret" name="plaid_secret" placeholder="secret key" autocomplete="off" class="w-full rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20" />
                                <p class="text-xs text-muted-foreground">Use sandbox credentials for demos.</p>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <label class="text-sm font-medium text-foreground" for="plaidEnvironment">Environment</label>
                            <select id="plaidEnvironment" name="plaid_environment" class="w-full rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20">
                                <option value="sandbox">Sandbox (testing)</option>
                                <option value="development">Development</option>
                                <option value="production">Production (live)</option>
                            </select>
                        </div>
                        <div class="mt-6 flex flex-wrap items-center gap-3">
                            <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-border/70 bg-muted/60 px-4 py-2 text-sm font-medium text-foreground transition hover:border-primary/40 hover:text-primary" onclick="testPlaidConnection()">
                                <span id="plaidTestSpinner" class="inline-flex items-center gap-2 text-sm font-medium text-muted-foreground" style="display: none;">
                                    <div class="h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground/40 border-t-primary"></div>
                                    Testing
                                </span>
                                <span id="plaidTestText">Test configuration</span>
                            </button>
                        </div>
                    </form>
                </div>

                <div class="flex flex-wrap items-center justify-between gap-3 border-t border-border/60 pt-6">
                    <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-border/70 px-4 py-2 text-sm font-medium text-foreground transition hover:border-border hover:bg-card/80" onclick="prevStep()">
                        <i data-lucide="arrow-left" class="h-4 w-4"></i>
                        Back to Stripe
                    </button>
                    <div class="flex flex-wrap items-center gap-3">
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-transparent px-4 py-2 text-sm font-medium text-muted-foreground transition hover:text-foreground" onclick="skipPlaid()">Skip for now</button>
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg bg-primary px-5 py-2.5 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90" onclick="nextStep()" id="plaidNext" disabled>
                            Continue to Xero
                            <i data-lucide="arrow-right" class="h-4 w-4"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 3: Xero -->
        <section class="step" id="step3" style="display: none;">
            <div class="card border border-border/70 p-6 space-y-6">
                <div class="space-y-3">
                    <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-muted-foreground">
                        Step 3 of 4
                    </span>
                    <h2 class="text-2xl font-semibold text-foreground">Configure Xero OAuth</h2>
                    <p class="text-sm leading-relaxed text-muted-foreground">Create a confidential application in the Xero developer portal, then paste the client ID and secret here.</p>
                </div>

                <div id="xero-messages" class="space-y-3"></div>

                <div class="card border border-border/70 p-6" id="xeroCard">
                    <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
                        <div class="flex items-center gap-3">
                            <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                                <i data-lucide="file-text" class="h-5 w-5"></i>
                            </span>
                            <div>
                                <h3 class="text-base font-semibold text-foreground">Xero OAuth credentials</h3>
                                <p class="mt-1 text-sm text-muted-foreground">After validation, the wizard manages refresh tokens for you.</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground" id="xeroStatus">Pending</span>
                    </div>

                    <form id="xeroForm" onsubmit="event.preventDefault();" class="space-y-4">
                        <div class="grid gap-4 md:grid-cols-2">
                            <div class="space-y-2">
                                <label class="text-sm font-medium text-foreground" for="xeroClientId">Xero client ID</label>
                                <input type="text" id="xeroClientId" name="xero_client_id" placeholder="client id" autocomplete="off" class="w-full rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20" />
                            </div>
                            <div class="space-y-2">
                                <label class="text-sm font-medium text-foreground" for="xeroClientSecret">Xero client secret</label>
                                <input type="password" id="xeroClientSecret" name="xero_client_secret" placeholder="client secret" autocomplete="off" class="w-full rounded-lg border border-border/70 bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20" />
                            </div>
                        </div>
                        <div class="mt-6 flex flex-wrap items-center gap-3">
                            <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-border/70 bg-muted/60 px-4 py-2 text-sm font-medium text-foreground transition hover:border-primary/40 hover:text-primary" onclick="testXeroConnection()">
                                <span id="xeroTestSpinner" class="inline-flex items-center gap-2 text-sm font-medium text-muted-foreground" style="display: none;">
                                    <div class="h-4 w-4 animate-spin rounded-full border-2 border-muted-foreground/40 border-t-primary"></div>
                                    Testing
                                </span>
                                <span id="xeroTestText">Validate credentials</span>
                            </button>
                        </div>
                    </form>
                </div>

                <div class="flex flex-wrap items-center justify-between gap-3 border-t border-border/60 pt-6">
                    <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-border/70 px-4 py-2 text-sm font-medium text-foreground transition hover:border-border hover:bg-card/80" onclick="prevStep()">
                        <i data-lucide="arrow-left" class="h-4 w-4"></i>
                        Back to Plaid
                    </button>
                    <div class="flex flex-wrap items-center gap-3">
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-transparent px-4 py-2 text-sm font-medium text-muted-foreground transition hover:text-foreground" onclick="skipXero()">Skip for now</button>
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg bg-primary px-5 py-2.5 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90" onclick="nextStep()" id="xeroNext" disabled>
                            Continue to Connect Xero
                            <i data-lucide="arrow-right" class="h-4 w-4"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 4: Connect Xero -->
        <section class="step" id="step4" style="display: none;">
            <div class="card border border-border/70 p-6 space-y-6">
                <div class="space-y-3">
                    <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.28em] text-muted-foreground">
                        Step 4 of 4
                    </span>
                    <h2 class="text-2xl font-semibold text-foreground">Connect Xero organisation</h2>
                    <p class="text-sm leading-relaxed text-muted-foreground">Authorize Financial Command Center to access your Xero organisation using OAuth. Keep this wizard open while you complete the flow in a new tab.</p>
                </div>

                <div id="connect-xero-messages" class="space-y-3"></div>

                <div class="card border border-border/70 p-6">
                    <div class="flex flex-wrap items-start justify-between gap-3 mb-4">
                        <div class="flex items-center gap-3">
                            <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                                <i data-lucide="link-2" class="h-5 w-5"></i>
                            </span>
                            <div>
                                <h3 class="text-base font-semibold text-foreground">Xero OAuth connection</h3>
                                <p class="mt-1 text-sm text-muted-foreground">Launch the OAuth consent flow, then confirm the tenant connection.</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center gap-2 rounded-full border border-border/70 bg-muted/60 px-3 py-1 text-xs font-semibold uppercase tracking-[0.24em] text-muted-foreground" id="connectXeroStatus">Pending</span>
                    </div>

                    <div class="space-y-4">
                        <p class="text-sm leading-relaxed text-muted-foreground">When the OAuth window opens, sign in with your Xero account, approve access, and select the organisation to link. Afterwards, return here and verify the connection.</p>
                        <div class="flex flex-wrap items-center gap-3">
                            <button type="button" class="inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90" onclick="launchXeroOAuth()">
                                Connect Xero
                                <i data-lucide="external-link" class="h-4 w-4"></i>
                            </button>
                            <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-border/70 bg-muted/60 px-4 py-2 text-sm font-medium text-foreground transition hover:border-primary/40 hover:text-primary" onclick="checkXeroConnection()">
                                Check connection
                                <i data-lucide="refresh-cw" class="h-4 w-4"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="flex flex-wrap items-center justify-between gap-3 border-t border-border/60 pt-6">
                    <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-border/70 px-4 py-2 text-sm font-medium text-foreground transition hover:border-border hover:bg-card/80" onclick="prevStep()">
                        <i data-lucide="arrow-left" class="h-4 w-4"></i>
                        Back to Xero OAuth
                    </button>
                    <div class="flex flex-wrap items-center gap-3">
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-transparent px-4 py-2 text-sm font-medium text-muted-foreground transition hover:text-foreground" onclick="skipXeroConnect()">Skip for now</button>
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg bg-primary px-5 py-2.5 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90" onclick="finishSetup()" id="connectXeroFinish" disabled>
                            Finish setup
                            <i data-lucide="check" class="h-4 w-4"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Completion -->
        <section class="step" id="completion" style="display: none;">
            <div class="card border border-border/70 p-10 text-center space-y-8">
                <div class="inline-flex h-16 w-16 items-center justify-center rounded-full bg-primary/15 text-3xl text-primary mx-auto">
                    <i data-lucide="sparkles" class="h-8 w-8"></i>
                </div>
                <div class="space-y-3">
                    <h2 class="text-2xl font-semibold text-foreground">Setup complete</h2>
                    <p class="max-w-xl mx-auto text-sm text-muted-foreground">All integrations have been saved securely. Complete your setup by connecting AI assistants and automation tools.</p>
                </div>

                <div id="completion-messages" class="space-y-3"></div>

                <!-- AI & Automation Connections -->
                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-foreground">Connect AI & Automation</h3>
                    <div class="grid gap-4 md:grid-cols-3 max-w-4xl mx-auto">
                        <div class="card border border-border/70 p-6 text-left">
                            <div class="flex items-start gap-3">
                                <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                                    <i data-lucide="bot" class="h-5 w-5"></i>
                                </span>
                                <div class="space-y-2">
                                    <h4 class="text-base font-semibold text-foreground">Connect to Claude</h4>
                                    <p class="text-sm text-muted-foreground">Generate Claude Desktop config for seamless AI integration.</p>
                                    <a href="/claude/setup" class="inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90">
                                        Setup Claude
                                        <i data-lucide="external-link" class="h-4 w-4"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="card border border-border/70 p-6 text-left">
                            <div class="flex items-start gap-3">
                                <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                                    <i data-lucide="zap" class="h-5 w-5"></i>
                                </span>
                                <div class="space-y-2">
                                    <h4 class="text-base font-semibold text-foreground">Configure Warp</h4>
                                    <p class="text-sm text-muted-foreground">Set up automation workflows and data pipelines.</p>
                                    <a href="/warp/setup" class="inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90">
                                        Setup Warp
                                        <i data-lucide="external-link" class="h-4 w-4"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="card border border-border/70 p-6 text-left">
                            <div class="flex items-start gap-3">
                                <span class="inline-flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full border-primary/20 bg-primary/10 text-primary">
                                    <i data-lucide="message-circle" class="h-5 w-5"></i>
                                </span>
                                <div class="space-y-2">
                                    <h4 class="text-base font-semibold text-foreground">Connect to ChatGPT</h4>
                                    <p class="text-sm text-muted-foreground">Configure AI assistant for financial insights and queries.</p>
                                    <a href="/assistant" class="inline-flex items-center gap-2 rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition hover:bg-primary/90">
                                        AI Assistant
                                        <i data-lucide="external-link" class="h-4 w-4"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Options -->
                <div class="space-y-3">
                    <p class="text-sm text-muted-foreground">Or proceed to the dashboard to manage your integrations</p>
                    <div class="flex flex-wrap items-center justify-center gap-3">
                        <a class="inline-flex items-center gap-2 rounded-lg border border-border/70 px-5 py-2.5 text-sm font-medium text-foreground transition hover:border-border hover:bg-card/80" href="/admin/dashboard">
                            Dashboard
                            <i data-lucide="arrow-right" class="h-4 w-4"></i>
                        </a>
                        <a class="inline-flex items-center gap-2 rounded-lg border border-border/70 px-4 py-2 text-sm font-medium text-foreground transition hover:border-border hover:bg-card/80" href="/health">
                            System health
                        </a>
                        <button type="button" class="inline-flex items-center gap-2 rounded-lg border border-transparent px-4 py-2 text-sm font-medium text-muted-foreground transition hover:text-foreground" onclick="location.reload()">Run wizard again</button>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<style>
.step {
    display: none;
}
.step.active {
    display: block;
}
</style>

<script src="{{ url_for('static', filename='js/setup-wizard.js') }}"></script>

{% endblock %}

